
\subsection{Ring-LWE}
One of the recurring problems in lattice-based cryptography is the key-size and general efficiency. In the GGH cryptosystem, the key-size is $\tilde{O}(n^4)$. In the system based on the hardness of LWE presented in the previous section, the size is in the range of $\tilde{O}(n^2)$\footnote{There are $m$ samples of length $n$. Turns out that for $m > n$, the problem can become only easier, but the same holds for $m \ll n$. Therefore, in most applications, $m$ is chosen to be roughly the size of $n$.}. As we will also see later, there is some minimal efficiency needed for the scheme in order to enable the boostrapping (for FHE). Unfortunately, none of the schemes presented so far satisfy those criterions and so, we need to look for something better.

One idea to improve the efficiency, is to assume some underlying structure of the space we are performing computations in. For example, we can assume that the $\bm{a}$ vectors from previous section are given to us in block of $n$ samples $\bm{a}_1, \bm{a}_2, \dots, \bm{a}_n \in \Z_q^n$ where all of the elements are related. Namely, $\bm{a}_1 = (a_1, \dots, a_n)$ is again chosen uniformly but each $\bm{a}_i = (a_i, \dots, a_n, -a_1, \dots, -a_{i - 1})$ is a ``anti-cyclic'' of the initial $\bm{a}_1$. This choice seems rather arbitrary however we will show how it is a natural consequence of everything we did so far and yields arguably the best results. For example if $n = 4$ and $q = 17$ and $\bm{a}_1 = (1, 16, 4, 5)$ as before, then $\bm{a}_3$ has the form $(4, 5, -1, -16) = (4, 5, 16, 1)$. Note that representing $n$ vectors now takes only $O(n)$ elements from $\Z_q$ rather than $O(n^2)$. The underlying structure is a ring, hence the name ring-LWE (or R-LWE), that is, we replace the group $\Z_q^n$ by picking some ring $R$ of degree $n$ over $\Z$ and a positive modulus $q$ defining the quotient ring $R_q := R/qR$. In this exposition, to simplify some steps, $R$ is taken to be a \textit{cyclotomic} ring - i.e. $R_q = \Z_q[x]/ (x^n + 1 )$ for $n = 2^k$ which turns out to yield much simpler proofs for somewhat weaker results.

In the year 2010, Vadim Lyubashevski, Chris Peikert and Oded Regev presented their paper ``On Ideal Lattices and Learning With Errors Over Rings'' \cite{ring-lwe}. The main purpose of the paper was to ``translate'' the LWE problem onto a ring as was done with the SIS problem (mainly by Micciancio \cite{ring-sis} that was followed up by other works but these results are not presented in this paper) and followed the heuristic approach behind the NTRU\footnote{As mentioned by Peikert in his survey: ``The meaning of the acronym NTRU is somewhat mysterious; plausible candidates include "$N$th degree \textit{tru}ncated polynomial ring" and "Number Theorists ’R’ Us."'' - \cite{lattice-survey}} cryptosystem \cite{ntru}. This in particular means first, defining the ring-LWE and later proving the hardness based on some difficult lattice problems like \prob{SVP} along with pseudorandomness of the ring-LWE distribution (analogous to \ref{s-to-d} whose definition will appear later). The second issue turned out to be quite nontrivial and required good insight in the algebraic number theory as well as Gaussian measures and distributions.

Somewhat analogous to the previous section, this one is also split into two main parts. First part - Section \ref{h-rlwe} - focuses on the hardness of the search version of the RLWE. The approach is identical to the one presented for the standard LWE. However, one needs to pay attention to details that are implied by the shift to $R$ like for example the shape of the error distribution under the canonical embedding. Fortunately for us, the quantum part of the reduction can be adopted almost as is and so, we will only mention it briefly. The second part - Section \ref{pseudo-rlwe} - deals with pseudorandomness of the RLWE distribution and thus proving the equivalence between the search and decision versions. This one will require much more insight into the algebraic number theory compared to any other part of this paper and so, we will discuss it in much more detail. Before we dwell any further, we need to establish some terminology and useful lemmas. This is done in the following section.

\subsubsection{Preliminaries}
In this section we will formally introduce the underlying ring structure that will be used throughout this section. We will try to spell out in more detail facts and results that are used implicitly in the original \cite{ring-lwe} providing few examples along the way. Most of those results will mostly be useful for the second part which is the decision to search reduction. In the first part, the hardness of search version, holds for any number field, not only cyclotomic.

Let us therefore fix a cyclotomic number field $K$ of degree $n$. More precisely, if we take $m = 2^k$ for some $k \geq 2$ and set $n = \phi(m) = m/2 = 2^{k-1}$, then by Corollary \ref{2k-cycl} we obtain
\[ K := \Q[x]/\Phi_m(x) = \Q[x]/(x^n + 1) \cong \Q(\zeta), \]
where $\zeta = \exp(2 \pi \sqrt{-1}/m)$ is the $m$-th root of unity. Finally, we define
\begin{equation} R := \Oo_K = \Z[\zeta] \end{equation}
where the equality holds by Proposition \ref{cycl-ok} and therefore is generated by $\{1, \zeta, \dots, \zeta^{n-1} \}$.

Recall

This ring however is slightly too big for our desire. Analogously to the LWE case we therefore consider the coset obtained by reducing all elements modulo some integer $q$. Let us now consider two specific cases.
\subsubsection{Background}
We begin this section by specifying some details on the underlying ring along with its desired properties. We will also introduce all the necessary definitions of the RLWE distribution analogous to the section on standard LWE. We could not find one single source that would cover all of the details necessary, however a good choice would be \cite{algebra}, \cite{stein} or \cite{milne}. For a good discussion on the \textit{different} idal, see Keith Conrads \href{https://kconrad.math.uconn.edu/blurbs/gradnumthy/different.pdf}{paper}.

\paragraph{Algebraic Number Theory II}
In this part we will introduce all the properties of the underlying ring version of LWE.

As will be evident later, when working with lattices and embeddings in $\C$, it is convenient to introduce
\begin{definition}[The space H]
\end{definition}
\begin{definition}[Canonical embedding]
\end{definition}
\begin{definition}[Trace]
\end{definition}
\begin{definition}[Norm]
\end{definition}
\begin{definition}[Dual]
\end{definition}

\pinar{For cyclotomic fields, how does this dual look like?}

\paragraph{Why cyclotomic?}\label{why?}
As mentioned earlier, we wish to fix the degree of our cyclotomic polynomial to a power-of-two. This leads to greatly simplified proofs of some results like for example search-to-decision reduction in section \ref{pseudo-rlwe}. Nonetheless, in places where it is not necessary, we will be using arbitrary number fields, sometimes not even cyclotomic. We will now list few desirable properties of cyclotomic rings (also those of power of two) that will be useful for us later on. Let us fix $m$, $n$ and $k$ to some positive integers.
\begin{itemize}
	\item Under the canonical embedding, the cyclotomic ring $R = \Oo_K$ for $\Phi_m(x) = x^{\phi(m)} - 1$ embeds as a lattice which in general, is not self-dual (this is only the case for $\Z^n$). Instead, its dual lattice corresponds to a fractional ideal $\Rd \subset K$ such that $R \subseteq \Rd \subseteq m^{-1}R$. In the case where $n = \varphi(m) =  2^{k-1}$ these two are actually equivalent, namely $\Rd = n^{-1}R$. 
	\item Polynomial arithmetic modulo $\Phi_m(X)$ can be performed very efficiently using slightly adjusted, classical $n$-dimensional FFT - \cite{toolkit}, \cite{swift}.
	\item In general, the smaller the shortest vector $\lambda_1(\Ll)$ is, the less secure the system. Cyclotomic fields have relatively large $\lambda_1(\Rd)$ - \cite{oracle}.
	\item In fact, for $n = 2^k$, we have $\lambda_n(\Rd) = 1/\sqrt{n}$
		\iffalse
	\item They also have relatively small \textit{expansion factors} (roughly speaking it is the ratio of the size of the public key to the size of the secret key) as defined and explained in \cite{expansion}.
		\fi
\end{itemize}
Unfortunately, cyclotomic fields with degree of a power-of-two are quite rare and restrictive. Imagine that our system is deemed insecure for some large $n = 2^k$. It might so happen that the next power of two is completely impractical when implemented. We should be able to find something inbetween the two instead.
Cyclotomic number fields have \textit{Galois} group
\paragraph{The RLWE distribution}

\pinar{Add explicit examples?? Fix a quadratic field $\Q(\zeta_3)$ or $\Q(\sqrt{-1})$ and so on.}

\begin{definition}[Ring-LWE Distribution]
	For $s \in \Rd_q$ (the ``secret'') and an error distribution $\psi$ over $K_{\R}$, a sample from the ring-LWE distribution $A_{s, \psi}$ over $R_q \cross \T$ is generated by choosing $a \leftarrow R_q$ uniformly at random, choosing $e \leftarrow \psi$, and outputting $(a, b = (a \cdot s)/q + e \mod \Rd)$.
\end{definition}
\begin{definition}[Ring-LWE, Search)]
	Let $\Psi$ be a family of distributions over $K_{\R}$. The search version of the ring-LWE problem, denoted R-LWE$_{q, \Psi}$, is defined as follows: given access to arbitrarily many independent samples from $A_{s, \psi}$ for some arbitrary $s \in \Rd_q$ and $\psi \in \Psi$, find $s$.
\end{definition}
From this point onwards, for $\alpha > 0$, we will denote by $\Psi_{\leq \alpha}$ the set of all elliptical Gaussian distributions $\D_{\bm{r}}$ (over $K_{\R}$) where each parameter $r_i \leq \alpha$.
\subsubsection{Hardness of search Ring-LWE}\label{h-rlwe}
We can finally discuss the main results from the \cite{ring-lwe}. This section focuses on the quantum reduction from $R$-LWE$_{q, \Psi_{\leq \alpha}}$ to the $K$-DGS$_{\gamma}$ - the approximate (to within $\gamma$) discrete Gaussian sampling problem (the definition for an arbitrary number field $K$ is created by simply replacing the lattice $\Ll$ with an ideal $\I$ in Definition \ref{dgs}, and so, the samples are defined to be from D$_{\I, r}$.). Note that all the results from this section apply to general number fields, not only cyclotomic.

The following is an equivalent of Theorem \ref{heart} of the classical LWE. Statement is almost identical however the proof turns out to be much more difficult to achieve than it may look at the first glimpse.
\begin{theorem}
	Let $K$ be an arbitrary number field of degree $n$ and $R = \Oo_K$. Let $\alpha = \alpha(n) > 0$, and let $q = q(n) \geq 2$ be such that $\alpha q > 2 \sqrt{n}$. For some negligible $\epsilon = \epsilon(n)$, there is a probabilistic polynomial-time quantum reduction from $K$-DGS$_{\gamma}$ to $R$-LWE$_{q,\Psi_{\leq \alpha}}$ where $\gamma > 0$ is usually taken\footnote{See the discussion just before Section 4.1 in \cite{ring-lwe}.} to be $\gamma = \omega(\log n)$.
\end{theorem}
And just as before, the proof relies on the (adjusted) \textit{iterative step} (IS) in parallel with the previous section. It presents as follows.
\begin{lemma}[Iterative Step]
Let $\epsilon = \epsilon(n)$ be a negligible function, $\alpha > 0$ real, and $q \geq 2$ be an integer. Assume that we have access to an oracle that solves LWE$_{q, \Psi_{\leq \alpha}}$ given a polynomial number of samples. Then, there exists an efficient quantum algorithm that, given a fractional ideal $\I$ in $K$, a number $r > \sqrt{2}q \cdot \eta_{\epsilon}(\I)$ and a (polynomial) list of samples from the discrete Gaussian distribution D$_{\I,r}$, produces a sample from D$_{\I,r \cdot \gamma/(\alpha q)}$.	
\end{lemma}
It is easy to notice that the statement is almost identical to the Lemma \ref{is}. The place of a $n$-dimensional lattice $\Ll$ has been taken up by a fractional ideal $\I$ (which, when embedded, lives in $\C^n$ as an $n$-dimensional lattice). The proof is also almost intact. We will use Lemma \ref{classical-rlwe} and Lemma \ref{quantum-rlwe} to create a sequence of discrete Gaussians with decreasing radii to obtain the solution to $K$-DGS$_{\gamma}$.
\begin{lemma}[Step 1 - classical]\label{classical-rlwe}
	Let $\epsilon = \epsilon(n)$ be a negligible function, $\alpha > 0$ real, and $q \geq 2$ be an integer with known factorization. Let $\I$ be a fractional ideal in $K$, and let $r \geq \sqrt{2}q \cdot \eta_{\epsilon}(\I)$. Given polynomial list of samples from the discrete Gaussian distribution D$_{\I,r}$, there is a probabilistic polynomial-time (classical) reduction from \prob{CVP}$_{\I^{\vee},d}$ to $R$-LWE$_{q,\Psi_{\leq \alpha}}$, where $d = \alpha q/(\sqrt{2}r)$.
\end{lemma}
\begin{remark}
	In the original statement in \cite{ring-lwe}, \prob{CVP} is replaced by \prob{BDD} to within the same distance. These statements are very similar with a simple difference that \prob{BDD} is concerned with finding \textit{any} lattice vector within $d$ whereas \prob{CVP} wants to find the \textit{closest} vector. Since the distance $d$ is less than $\lambda_1(\Ll)/2$, \prob{BDD} will find the closest, unique vector to $\Ll$. Hence, in this case, they are equivalent and we use \prob{CVP} to keep it consistent with previous section.
\end{remark}

We will proof the lemma using three steps.
\begin{proof}
	Just as before, it is enough to show reduction to \prob{CVP}$^{(q)}_{\I,d}$ by a similar argument. The high-lever reduction presents now as follows. We are given a \prob{CVP}$_{\I, d}$ instance $y = x + e$ where $x \in \Id$ and $\norm{e} \leq d$. We are also granted access to (as many as necessary) samples from the discrete Gaussian over $\I$ and standard deviation $r$ as well as an oracle for $R$-LWE \krzys{why do they not require an oracle for LWE in the assumptions?}\krzys{also, why do we need the theta u if the z is already taken from ideal I?}
\end{proof}
\subsubsection{Pseudorandomness of Ring-LWE}\label{pseudo-rlwe}
Just like in the case of classical LWE, we want to show that the ring-LWE distribution is pseudorandom - i.e. samples from the RLWE distribution are indistinguishable from truly random (uniform) ones. This is encapsulated in the following theorem \ref{d-to-s-rlwe}. We should fix some terminology first.\krzys{finish preliminaries}

Additionally, we will present a proof of a slightly simpler version of the result. Namely, instead of using a family of distributions over the Gaussian distributions which is required in a general case, we shall make one more assumption. This is, we will assume that the number of R-LWE samples given (for example to an adversary) is bounded and we will denote it by $l \geq 1$.
\begin{theorem}\label{d-to-s-rlwe}
	Let $R$ and $q$ be as above and let $\alpha q \geq \eta_{\epsilon}(\Rd)$ for some negligible $\epsilon = \epsilon(n)$. Then there is a reduction from $R$-LWE$_{q,\Psi}$ to $R$-DLWE$_{q,\D_{\xi}}$ given only $l$ samples, where $\xi = \alpha \cdot (nl/\log(nl))^{1/4}$.
\end{theorem}
The reduction follows from search-$R$-LWE to decision-$R$-LWE and in high-level, it consists of 4 steps presented in Figure \ref{fig:4reds} and described in more detail below.
\begin{enumerate}
	\item LWE$_{q, \Psi}$ to $\q_i$-LWE$_{q, \Psi}$.
\end{enumerate}

\begin{figure}[ht]
	\center
\begin{tikzpicture}
% Define the first acronym
	\node[draw, rounded corners=1mm, minimum width=2cm, minimum height=1cm] (A) at (0,0) {LWE$_{q, \Psi}$};

% Define the second acronym
	\node[draw, rounded corners=1mm, minimum width=2cm, minimum height=1cm] (B) at (3,0) {$\q_i$-LWE$_{q, \Psi}$};

% Define the third acronym
	\node[draw, rounded corners=1mm, minimum width=2cm, minimum height=1cm] (C) at (6,0) {WDLWE$^i_{q, \Psi}$};

% Define the fourth acronym
	\node[draw, rounded corners=1mm, minimum width=2cm, minimum height=1cm] (D) at (9,0) {DLWE$^i_{q, \D_{\xi}}$};

% Define the fifth acronym
\node [draw, rounded corners=1mm, minimum width=2cm, minimum height=1cm] (E) at (12,0) {DLWE$_{q, \D_{\xi}}$};

% Draw the arrows between the acronyms
	\draw[->, very thick] (A.east) -- node [above] {(1)} (B.west);
	\draw[->, very thick] (B.east) -- node [above] {(2)} (C.west);
	\draw[->, very thick] (C.east) -- node [above] {(3)} (D.west);
	\draw[->, very thick] (D.east) -- node [above] {(4)} (E.west);
\end{tikzpicture}
\caption{Schematic of reductions from R-LWE to R-DLWE}
\label{fig:4reds}
\end{figure}

\paragraph{Search to Worst-Case Decision}
We begin with the reduction of the LWE to $\q_i$-LWE distribution relative to only one $\q_i$ arbitrary prime ideal.
\begin{definition}
	The $\q_i$-LWE$_{q,\Psi}$ problem is: given access to A$_{s,\Psi}$ for some arbitrary $s \in \Rd_q$ and $\psi \in \Psi$, find $s \mod \q_i R$.
\end{definition}
\begin{lemma}[LWE to $\q_i$-LWE, Lemma 5.5 \cite{ring-lwe}]
	Suppose that the family $\Psi$ is closed under all the automorphisms of $K$, i.e., $\psi \in \Psi \Rightarrow \tau_k(\psi) \in \Psi$ for every $k \in \Z^*_m$. Then for every $i \in \Z^*_m$, there is a deterministic polynomial-time reduction from LWE$_{q, \Psi}$ to $\q_i$-LWE$_{q, \Psi}$.
\end{lemma}

\begin{proof}
	By assumptions, we are given access to an $\q_i$-LWE oracle along with $n$ field automorphisms $\tau_k$ that ``act transitively'' on the prime ideals $\q_i$ thanks to the underlying field being a cyclotomic number field. The idea is to use the oracle to recover the value of $s$ relative to every $\q_j\Rd$ using the automorphisms. Once we have that, we can (efficiently) recover the $s$ using the Chinese Remainder Theorem. 

	The reduction to find $s \mod \q_j \Rd$ works as follows: transform each given sample $(a,b) \leftarrow \text{A}_{s, \psi}$ to $(\tau_k(a), \tau_k(b)) \in R_q \cross \T$ where $k = j/i \in \Z^*_m$ which gives $\tau_k(\q_j) = \q_i$. Give the transformed sample to the oracle which outputs some $t \in \Rd / \q_i \Rd$. Since $\tau_k$ is a bijection, we can compute $\tau^{-1}_k(t) \in \Rd / \q_j \Rd$.

	We now need to verify that this output is actually equal to $s \mod \q_j \Rd$. This is equivalent to asking if $(\tau_k(a), \tau_k(b))$ is distributed according to A$_{\tau_k(s), \psi '}$ for $\psi ' = \tau_k(\psi)$. First, note that the automorphisms fix the underlying structure. Namely, $\tau_k(\Rd) = \Rd$ and $\tau_k(\T) = \T = K_{\R}/\Rd$ and in particular, $\tau_k(q) = q$ for any $k \in \Z_m^*$. We therefore have
	\[ \tau_k(b) = \tau_k(as)/q + \tau_k(e) \mod \Rd.\]
	If $a$ was uniformly distributed, $\tau_k(a)$ will be as well. The pairs are therefore distributed according to A$_{\tau_k(s), \psi '}$ for $\psi ' = \tau_k(\psi) \in \Psi$. The $t$ returned by an oracle must therefore be $t = \tau_k(s) \mod \q_i \Rd$ and so $\tau_k^{-1}(t) = s \mod \tau_k^{-1}(\q_i \Rd) = s \mod \q_j \Rd$ as required. 

	All we need to show now is that the automorphisms preserve the distribution. The proof is short and omited from here but can be found as Lemma 5.6 in \cite{ring-lwe}. As an outline, recall that the automorphisms simply permute the coordinates of the canonical embedding. So for any $\D_{\bm{r}}$ with each $r_i \leq \alpha$, it is sent to $\D_{\bm{r'}}$ where $\bm{r'}$ is simply the permutation of coefficients of the vector $\bm{r}$ and so, each $r_i' \leq \alpha$. Thus $\tau_k(\D_{\bm{r}}) \in \Psi_{\leq \alpha}$ as required.
\end{proof}


Chinese remainder theorem for rings --> Thm II.4.12 in Top's lecture notes. \\
For instance, they have unique factorization of ideals, and their fractional ideals form a multiplicative group; in general, neither property holds in $\Z[x]/\langle f (x) \rangle$ for monic irreducible $f (x)$, as demonstrated by the ring $\Z[x]/\langle x^2+3 \rangle = \Z[\sqrt{-3}]$. (For example, in this ring $4 = 22 = (1+\sqrt{-3})(1 - \sqrt{-3})$, but 2, $1 + \sqrt{-3}$, and $1 - \sqrt{-3}$ are all irreducible.)
Toward basing fully homomorphic encryption on worst-case hardness \\
One of the applications is \cite{qTESLA} signature scheme.
